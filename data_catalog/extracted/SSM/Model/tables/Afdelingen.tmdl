table Afdelingen

	column AfdelingKey
		dataType: int64
		formatString: 0
		summarizeBy: none
		sourceColumn: AfdelingKey

		annotation SummarizationSetBy = Automatic

	column ParentAfdelingKey
		dataType: int64
		formatString: 0
		summarizeBy: none
		sourceColumn: ParentAfdelingKey

		annotation SummarizationSetBy = Automatic

	column AfdelingRelatieKey
		dataType: int64
		formatString: 0
		summarizeBy: none
		sourceColumn: AfdelingRelatieKey

		annotation SummarizationSetBy = Automatic

	column AdministratieKey
		dataType: int64
		formatString: 0
		summarizeBy: none
		sourceColumn: AdministratieKey

		annotation SummarizationSetBy = Automatic

	column KostenplaatsKey
		dataType: int64
		formatString: 0
		summarizeBy: none
		sourceColumn: KostenplaatsKey

		annotation SummarizationSetBy = Automatic

	column Code
		dataType: string
		summarizeBy: none
		sourceColumn: Code

		annotation SummarizationSetBy = Automatic

	column Afdeling
		dataType: string
		summarizeBy: none
		sourceColumn: Afdeling

		annotation SummarizationSetBy = Automatic

	column Administratie
		dataType: string
		summarizeBy: none
		sourceColumn: Administratie

		annotation SummarizationSetBy = Automatic

	column PCPATH = PATH(Afdelingen[AfdelingKey],Afdelingen[ParentAfdelingKey])
		isHidden
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column Niveau = PATHLENGTH(Afdelingen[PCPATH])
		isHidden
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column 'Niveau 1' =
			
			LOOKUPVALUE(
			    Afdelingen[Afdeling]
			    ,Afdelingen[AfdelingKey]
			    ,PATHITEM(Afdelingen[PCPATH],1,1)
			)
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column 'Niveau 2' =
			
			IF(
			    Afdelingen[Niveau] >=2
			    ,LOOKUPVALUE(
			        Afdelingen[Afdeling]
			        ,Afdelingen[AfdelingKey]
			        ,PATHITEM(Afdelingen[PCPATH],2,1)
			    )
			    ,Afdelingen[Niveau 1]
			)
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column 'Niveau 3' =
			
			IF(
			    Afdelingen[Niveau] >= 3
			    , LOOKUPVALUE(
			        Afdelingen[Afdeling]
			        , Afdelingen[AfdelingKey]
			        , PATHITEM( Afdelingen[PCPATH], 3, 1 )
			    )
			    , Afdelingen[Niveau 2]
			)
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column 'Niveau 4' =
			
			IF(
			    Afdelingen[Niveau] >=4
			    ,LOOKUPVALUE(
			        Afdelingen[Afdeling]
			        ,Afdelingen[AfdelingKey]
			        ,PATHITEM(Afdelingen[PCPATH],4,1)
			    )
			    ,Afdelingen[Niveau 3]
			)
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column 'Afdeling code en omschrijving'
		dataType: string
		summarizeBy: none
		sourceColumn: Afdeling code en omschrijving

		annotation SummarizationSetBy = Automatic

	hierarchy 'Afdeling Hierarchy'

		level Hoofdafdeling
			column: 'Niveau 1'

		level Subafdeling
			column: 'Niveau 2'

		level 'Niveau 3'
			column: 'Niveau 3'

		level 'Niveau 4'
			column: 'Niveau 4'

	partition Afdelingen = m
		mode: import
		queryGroup: Stam
		source =
				let
				    View = "SSM Afdelingen",
				    Source =PostgreSQL.Database(#"3_server",#"4_database"),
				    #"Notifica_SSM" = Source{[Schema=#"5_schema",Item=View]}[Data]
				in
				    #"Notifica_SSM"

	annotation PBI_ResultType = Table

	annotation PBI_NavigationStepName = Navigation

